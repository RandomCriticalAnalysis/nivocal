<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>What the Package Does (One Line, Title Case) • nivocal</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha256-eZrrJcwDc/3uDhsdt61sL2oOBY362qM3lon1gyExkL0=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- sticky kit --><script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script><!-- pkgdown --><link href="pkgdown.css" rel="stylesheet">
<script src="pkgdown.js"></script><meta property="og:title" content="What the Package Does (One Line, Title Case)">
<meta property="og:description" content="What the package does (one paragraph).">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="index.html">nivocal</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.0.0.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="reference/index.html">Reference</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><div class="row">
  <div class="col-md-9 contents">
    

    
    
<!-- README.md is generated from README.Rmd. Please edit that file -->
<div id="making-of-nivocal" class="section level1">
<div class="page-header"><h1 class="hasAnchor">
<a href="#making-of-nivocal" class="anchor"></a>Making of nivocal</h1></div>
<p><code>nivocal</code> was built to be a working package, but while I was at it I wanted to record each step in the creation journey as a reference for future authors of <a href="https://github.com/react-R/reactR"><code>reactR</code></a>-based <code>htmlwidgets</code>. For reference, the package in its initial working state required less than 30 minutes of effort. I never left my RStudio window, and I only had to write 1.5 lines of JavaScript.</p>
<div id="one-time-on-the-internet-i-found" class="section level2">
<h2 class="hasAnchor">
<a href="#one-time-on-the-internet-i-found" class="anchor"></a>One Time on the Internet I Found …</h2>
<p>There are some amazing <a href="https://reactjs.org/"><code>React</code></a> comoponents out there. If one day on the Internet, you find something you like then it can be ready to use in R in less than an hour (hopefully shorter if you read this document). Take for example the <a href="https://nivo.rocks/components">@nivo</a> set of components. I’d like to use the Github-style <a href="https://nivo.rocks/calendar/">calendar</a>.</p>
<div class="figure">
<img src="reference/figures/nivocal_site_screenshot.PNG" alt="screenshot of nivo calendar"><p class="caption">screenshot of nivo calendar</p>
</div>
</div>
<div id="starting-the-package" class="section level2">
<h2 class="hasAnchor">
<a href="#starting-the-package" class="anchor"></a>Starting the Package</h2>
<p><a href="https://github.com/r-lib/usethis"><code>usethis</code></a> allows us to create a package in one line of code. Let’s begin our journey here.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" title="1">usethis<span class="op">::</span><span class="kw"><a href="https://www.rdocumentation.org/packages/usethis/topics/create_package">create_package</a></span>(<span class="st">"nivocal"</span>)</a></code></pre></div>
<div class="figure">
<img src="reference/figures/nivocal2.gif" alt="screencast of creating package with use this"><p class="caption">screencast of creating package with use this</p>
</div>
</div>
<div id="scaffolding" class="section level2">
<h2 class="hasAnchor">
<a href="#scaffolding" class="anchor"></a>Scaffolding</h2>
<p>Once we have a package, we’ll open it up and then build a scaffold. Sometimes finding the <code>npmPkgs</code> argument can be a little tricky. Usually, the best clues are in the docs, but we can also use <a href="https://unpkg.com">unpkg.com</a>–the CRAN of Node JavaScript–for some help. End the url with <code>/</code> to see the contents of the package and find the most recent version. For the calender, we do <a href="https://unpkg.com/@nivo/calendar/">https://unpkg.com/<span class="citation">@nivo/calendar</span>/</a>. Remember the <code>/</code>. Try <a href="https://unpkg.com/@nivo/calendar">https://unpkg.com/<span class="citation">@nivo/calendar</span></a> to see the difference.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" title="1"><span class="kw">scaffoldReactWidget</span>(</a>
<a class="sourceLine" id="cb2-2" title="2">  <span class="st">"nivocal"</span>,</a>
<a class="sourceLine" id="cb2-3" title="3">  <span class="dt">npmPkgs =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="st">"@nivo/calendar"</span> =<span class="st"> "0.52.1"</span>)</a>
<a class="sourceLine" id="cb2-4" title="4">)</a></code></pre></div>
<div class="figure">
<img src="reference/figures/nivocal3.gif" alt="screencast of scaffolding the widget"><p class="caption">screencast of scaffolding the widget</p>
</div>
<p>Now we have all the files we need for a working <code>htmlwidget</code> but unfortunately not working in the way we want.</p>
</div>
<div id="lines-of-javascript-and-build" class="section level2">
<h2 class="hasAnchor">
<a href="#lines-of-javascript-and-build" class="anchor"></a>1.5 Lines of JavaScript and Build</h2>
<p>In the JavaScript, we will need to import the module we want to use. For <code>nivocal</code> we want <code>ResponsiveCalendar</code>. <code>import</code> in JavaScript is very similar to <code><a href="https://www.rdocumentation.org/packages/base/topics/library">library()</a></code> in R.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" title="1">import { ResponsiveCalendar } from <span class="st">'@nivo/calendar'</span></a></code></pre></div>
<p>The JavaScript build toolchain can get complicated, but fortunately <code>reactR</code> takes care of much of this for us. I hate to tell you, but you will need to install <a href="https://nodejs.org/en/download/"><code>node</code></a> and <a href="https://yarnpkg.com/lang/en/docs/install"><code>yarn</code></a>. I promise this is not hard or scary though. Once you have both installed, we will build/webpack our JavaScript in the RStudio terminal or other terminal/console.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" title="1">yarn install</a>
<a class="sourceLine" id="cb4-2" title="2">yarn run webpack</a></code></pre></div>
<div class="figure">
<img src="reference/figures/nivocal4.gif" alt="screencast of building the JavaScript"><p class="caption">screencast of building the JavaScript</p>
</div>
<p>The built JavaScript will be copied into the <code>/inst/htmlwidgets</code> directory ready for use in our R <code>htmlwidget</code>.</p>
</div>
<div id="build-r-package" class="section level2">
<h2 class="hasAnchor">
<a href="#build-r-package" class="anchor"></a>Build R Package</h2>
<p>We have a couple more things to do on the <code>R</code> side. For now, let’s see if the package builds. In RStudio, we can <code>CTRL + Shift + B</code> or</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" title="1">devtools<span class="op">::</span><span class="kw"><a href="https://www.rdocumentation.org/packages/devtools/topics/document">document</a></span>()</a>
<a class="sourceLine" id="cb5-2" title="2">devtools<span class="op">::</span><span class="kw"><a href="https://www.rdocumentation.org/packages/devtools/topics/install">install</a></span>(<span class="dt">quick =</span> <span class="ot">TRUE</span>)</a></code></pre></div>
<div class="figure">
<img src="reference/figures/nivocal5.gif" alt="screencast of building the R package"><p class="caption">screencast of building the R package</p>
</div>
<p>If all goes well, then our package is working, but as I said just not quite in the way we want.</p>
</div>
<div id="add-some-arguments" class="section level2">
<h2 class="hasAnchor">
<a href="#add-some-arguments" class="anchor"></a>Add Some Arguments</h2>
<p>Now we need a way to go from R to JavaScript. We’ll add arguments for the <code>data</code>, <code>from</code>, and <code>to</code> component <code>props</code> in our <code>R</code> function.</p>
<div class="figure">
<img src="reference/figures/nivocal6.gif" alt="screencast of add R function arguments"><p class="caption">screencast of add R function arguments</p>
</div>
</div>
<div id="change-the-tag" class="section level2">
<h2 class="hasAnchor">
<a href="#change-the-tag" class="anchor"></a>Change the Tag</h2>
<p>The scaffold uses <code>div</code>, but we want to use the <code>ResponsiveCalendar</code> component. <code>React</code> components are always <a href="https://reactjs.org/docs/jsx-in-depth.html#user-defined-components-must-be-capitalized">capitalized</a>.</p>
<div class="figure">
<img src="reference/figures/nivocal7.gif" alt="screencast of change tag to component"><p class="caption">screencast of change tag to component</p>
</div>
</div>
<div id="add-more-propsoptions-and-do-some-r-work" class="section level2">
<h2 class="hasAnchor">
<a href="#add-more-propsoptions-and-do-some-r-work" class="anchor"></a>Add More Props/options and Do Some R Work</h2>
<p>There are a lot of other options for the calendar. For a well-built R package, I think each of these should be dcoumented arguments, but for now we’ll use <code>...</code> to pass other options from R to JavaScript.</p>
<p><code>data</code>, <code>from</code>, and <code>to</code> are required for the calendar component. Eventually, we want to accept various forms of <code>data</code> from the user, but for now we will assume the user provides a <code>data.frame</code> with two columns <code>day</code> and <code>value</code>. <code>htmlwidgets</code> communicate <code>data.frames</code> as an <a href="https://www.htmlwidgets.org/develop_advanced.html#data-transformation">array of arrays</a> but <code>ResponsiveCalendar</code> wants the equivalent of <code>dataframe = "rows"</code> in <code><a href="https://www.rdocumentation.org/packages/jsonlite/topics/fromJSON">jsonlite::toJSON()</a></code>. We’ll use <code>mapply</code> to do this, but as described in the <a href="https://www.htmlwidgets.org/develop_advanced.html#data-transformation">data transformation</a> article we have other methods to achieve this. The most common form – using JavaScript <code>HTMLWidgets.dataframeToD3()</code> – does not currently work well with <code>reactR</code>-based <code>htmlwidgets</code>.</p>
<p>Without <code>from</code> and <code>to</code>, the calendar will not render, so let’s assume the user wants <code>from</code> to be the first row of the data and <code>to</code> to be the last row.</p>
<div class="figure">
<img src="reference/figures/nivocal8.gif" alt="screencast of use ellipsis for other options and munge arguments"><p class="caption">screencast of use ellipsis for other options and munge arguments</p>
</div>
</div>
<div id="its-working" class="section level2">
<h2 class="hasAnchor">
<a href="#its-working" class="anchor"></a>It’s Working</h2>
<p>Now we have a working <code>htmlwidget</code>. Build the package with <code>CTRL+Shift+B</code> or</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" title="1">devtools<span class="op">::</span><span class="kw"><a href="https://www.rdocumentation.org/packages/devtools/topics/document">document</a></span>()</a>
<a class="sourceLine" id="cb6-2" title="2">devtools<span class="op">::</span><span class="kw"><a href="https://www.rdocumentation.org/packages/devtools/topics/install">install</a></span>(<span class="dt">quick =</span> <span class="ot">TRUE</span>)</a></code></pre></div>
<p>Give it some data and see an interactive calendar.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb7-1" title="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(nivocal)</a>
<a class="sourceLine" id="cb7-2" title="2"></a>
<a class="sourceLine" id="cb7-3" title="3"><span class="co"># fake data of 500 records/days starting 2017-03-15</span></a>
<a class="sourceLine" id="cb7-4" title="4">df &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/data.frame">data.frame</a></span>(</a>
<a class="sourceLine" id="cb7-5" title="5">  <span class="dt">day =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/seq.Date">seq.Date</a></span>(</a>
<a class="sourceLine" id="cb7-6" title="6">    <span class="dt">from =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/as.Date">as.Date</a></span>(<span class="st">"2017-03-15"</span>),</a>
<a class="sourceLine" id="cb7-7" title="7">    <span class="dt">length.out =</span> <span class="dv">500</span>,</a>
<a class="sourceLine" id="cb7-8" title="8">    <span class="dt">by =</span> <span class="st">"days"</span></a>
<a class="sourceLine" id="cb7-9" title="9">  ),</a>
<a class="sourceLine" id="cb7-10" title="10">  <span class="dt">value =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/Round">round</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/Uniform">runif</a></span>(<span class="dv">500</span>)<span class="op">*</span><span class="dv">1000</span>, <span class="dv">0</span>)</a>
<a class="sourceLine" id="cb7-11" title="11">)</a>
<a class="sourceLine" id="cb7-12" title="12"></a>
<a class="sourceLine" id="cb7-13" title="13"><span class="kw"><a href="reference/nivocal.html">nivocal</a></span>(df)</a></code></pre></div>
<div class="figure">
<img src="reference/figures/nivocal9.gif" alt="screencast of working package widget"><p class="caption">screencast of working package widget</p>
</div>
</div>
<div id="customize" class="section level2">
<h2 class="hasAnchor">
<a href="#customize" class="anchor"></a>Customize</h2>
<p>Remember we added <code>...</code> for further customization. Let’s see how this works.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb8-1" title="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(nivocal)</a>
<a class="sourceLine" id="cb8-2" title="2"></a>
<a class="sourceLine" id="cb8-3" title="3"><span class="co"># fake data of 500 records/days starting 2017-03-15</span></a>
<a class="sourceLine" id="cb8-4" title="4">df &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/data.frame">data.frame</a></span>(</a>
<a class="sourceLine" id="cb8-5" title="5">  <span class="dt">day =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/seq.Date">seq.Date</a></span>(</a>
<a class="sourceLine" id="cb8-6" title="6">    <span class="dt">from =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/as.Date">as.Date</a></span>(<span class="st">"2017-03-15"</span>),</a>
<a class="sourceLine" id="cb8-7" title="7">    <span class="dt">length.out =</span> <span class="dv">500</span>,</a>
<a class="sourceLine" id="cb8-8" title="8">    <span class="dt">by =</span> <span class="st">"days"</span></a>
<a class="sourceLine" id="cb8-9" title="9">  ),</a>
<a class="sourceLine" id="cb8-10" title="10">  <span class="dt">value =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/Round">round</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/Uniform">runif</a></span>(<span class="dv">500</span>)<span class="op">*</span><span class="dv">1000</span>, <span class="dv">0</span>)</a>
<a class="sourceLine" id="cb8-11" title="11">)</a>
<a class="sourceLine" id="cb8-12" title="12"></a>
<a class="sourceLine" id="cb8-13" title="13"><span class="kw"><a href="reference/nivocal.html">nivocal</a></span>(</a>
<a class="sourceLine" id="cb8-14" title="14">  df,</a>
<a class="sourceLine" id="cb8-15" title="15">  <span class="dt">direction =</span> <span class="st">"vertical"</span>,</a>
<a class="sourceLine" id="cb8-16" title="16">  <span class="dt">colors =</span> RColorBrewer<span class="op">::</span><span class="kw"><a href="https://www.rdocumentation.org/packages/RColorBrewer/topics/ColorBrewer">brewer.pal</a></span>(<span class="dt">n=</span><span class="dv">9</span>, <span class="st">"Blues"</span>)</a>
<a class="sourceLine" id="cb8-17" title="17">)</a></code></pre></div>
<div class="figure">
<img src="reference/figures/nivocal10.gif" alt="screencast of more customization"><p class="caption">screencast of more customization</p>
</div>
</div>
<div id="more-resources" class="section level2">
<h2 class="hasAnchor">
<a href="#more-resources" class="anchor"></a>More Resources</h2>
<p>Even though all of this is fairly new, we have tried to offer examples and resources to ease the learning curve. The <a href="https://github.com/react-R">react-R Github organization</a> is intended to be a friendly central location for all things R + React. Please join in the fun.</p>
<ul>
<li><p><a href="https://resources.rstudio.com/rstudio-conf-2019/integrating-react-js-and-shiny">Alan Dipert rstudio::conf 2019 Video</a> hear from the creator himself</p></li>
<li><p><a href="https://react-r.github.io/reactR/articles/intro_htmlwidgets.html">Authoring reactR htmlwidgets tutorial</a></p></li>
<li><p><a href="https://github.com/react-R/sparklines-example">react-sparklines example package</a> great first example package</p></li>
<li><p><a href="https://github.com/react-R/roffice">office-fabric-ui example package</a> widget example with no JavaScript build steps</p></li>
<li><p><a href="https://github.com/react-R/MapboxGL-example">MapboxGL example package</a> package discussed in the rstudio::conf 2019 video</p></li>
<li><p><a href="https://github.com/react-R/forcer">forcer</a> <code>react-force-graph</code> example package for <code>2d</code>, <code>3d</code>, and virtual reality force directed network graphs.</p></li>
</ul>
</div>
<div id="vue" class="section level2">
<h2 class="hasAnchor">
<a href="#vue" class="anchor"></a>Vue</h2>
<p>We’d like to do the same for <code>Vue</code>. Please let us know if you have interest. <a href="https://github.com/timelyportfolio/vueR"><code>vueR</code></a> would be a good starting point.</p>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <div class="license">
<h2>License</h2>
<ul class="list-unstyled">
<li>What license it uses</li>
</ul>
</div>
<div class="developers">
<h2>Developers</h2>
<ul class="list-unstyled">
<li>First Last <br><small class="roles"> Author, maintainer </small>  </li>
</ul>
</div>

      </div>

</div>


      <footer><div class="copyright">
  <p>Developed by First Last.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.3.0.</p>
</div>
      </footer>
</div>

  

  </body>
</html>
